<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jogo de Perguntas</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-blue-200">
    <div id="game-board" class="w-full h-screen relative overflow-hidden bg-[url('static/images/background.png')] bg-repeat-x">
        <img src="static/images/clouds.png" class="cloud w-[500px] absolute animate-[cloud_20s_linear_infinite]">
        <img src="static/images/mario.gif" id="mario" class="w-[130px] absolute bottom-0 left-[50px]">
    </div>

    <div id="question-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center">
        <div class="bg-white p-8 rounded-lg max-w-md w-full">
            <h2 id="question-text" class="text-xl font-bold mb-4"></h2>
            <div id="answers" class="space-y-2"></div>
        </div>
    </div>

    <div id="congrats-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center">
        <div class="bg-white p-8 rounded-lg max-w-md w-full text-center">
            <h2 class="text-2xl font-bold mb-4">Parabéns!</h2>
            <p class="mb-6">Você completou todas as perguntas com sucesso!</p>
            <button id="next-level-btn" class="px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600">
                Próximo Nível
            </button>
        </div>
    </div>

    <div id="game-over-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center">
        <div class="bg-white p-8 rounded-lg max-w-md w-full text-center">
            <h2 class="text-2xl font-bold mb-4">Game Over</h2>
            <p class="mb-6">Você errou todas as perguntas desta sequência.</p>
            <button id="restart-btn" class="px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600">
                Reiniciar Fase
            </button>
        </div>
    </div>

    <script>
        const mario = document.getElementById('mario');
        const questionModal = document.getElementById('question-modal');
        const questionText = document.getElementById('question-text');
        const answersContainer = document.getElementById('answers');
        const congratsModal = document.getElementById('congrats-modal');
        const gameOverModal = document.getElementById('game-over-modal');
        const nextLevelBtn = document.getElementById('next-level-btn');
        const restartBtn = document.getElementById('restart-btn');

        let currentQuestionSet = 0;
        let currentQuestion = 0;
        let score = 0;
        let marioPosition = 50;

        const questions = [
            [
                {
                    question: "Qual é a capital do Brasil?",
                    answers: ["São Paulo", "Rio de Janeiro", "Brasília", "Salvador"],
                    correct: 2
                },
                {
                    question: "Quanto é 2 + 2?",
                    answers: ["3", "4", "5", "6"],
                    correct: 1
                },
                {
                    question: "Quem pintou a Mona Lisa?",
                    answers: ["Van Gogh", "Picasso", "Da Vinci", "Michelangelo"],
                    correct: 2
                }
            ],
            [
                {
                    question: "Qual é o maior planeta do sistema solar?",
                    answers: ["Terra", "Marte", "Júpiter", "Saturno"],
                    correct: 2
                },
                {
                    question: "Em que ano o homem pisou na Lua pela primeira vez?",
                    answers: ["1969", "1971", "1965", "1973"],
                    correct: 0
                },
                {
                    question: "Qual é o símbolo químico do ouro?",
                    answers: ["Ag", "Au", "Fe", "Cu"],
                    correct: 1
                }
            ],
            [
                {
                    question: "Quem escreveu 'Dom Quixote'?",
                    answers: ["Shakespeare", "Cervantes", "Machado de Assis", "Camões"],
                    correct: 1
                },
                {
                    question: "Qual é o maior oceano do mundo?",
                    answers: ["Atlântico", "Índico", "Ártico", "Pacífico"],
                    correct: 3
                },
                {
                    question: "Quantos continentes existem?",
                    answers: ["5", "6", "7", "8"],
                    correct: 2
                }
            ]
        ];

        function showQuestion() {
            const currentSet = questions[currentQuestionSet];
            if (currentQuestion >= currentSet.length) {
                if (score === 0) {
                    showGameOverModal();
                    return;
                }
                currentQuestionSet++;
                currentQuestion = 0;
                score = 0;
                if (currentQuestionSet >= questions.length) {
                    showCongratsModal();
                    return;
                }
            }

            const q = currentSet[currentQuestion];
            questionText.textContent = q.question;
            answersContainer.innerHTML = '';

            q.answers.forEach((answer, index) => {
                const button = document.createElement('button');
                button.textContent = answer;
                button.className = 'w-full p-2 bg-blue-500 text-white rounded hover:bg-blue-600';
                button.onclick = () => checkAnswer(index);
                answersContainer.appendChild(button);
            });

            questionModal.classList.remove('hidden');
        }

        function checkAnswer(answerIndex) {
            const currentSet = questions[currentQuestionSet];
            const q = currentSet[currentQuestion];

            if (answerIndex === q.correct) {
                score++;
            }

            currentQuestion++;
            questionModal.classList.add('hidden');

            if (currentQuestion >= currentSet.length) {
                setTimeout(showQuestion, 3000);
            } else {
                setTimeout(showQuestion, 100);
            }
        }

        function resetGame() {
            currentQuestionSet = 0;
            currentQuestion = 0;
            score = 0;
            marioPosition = 50;
            mario.style.left = '50px';
            gameOverModal.classList.add('hidden');
            setTimeout(showQuestion, 3000);
        }

        function showCongratsModal() {
            congratsModal.classList.remove('hidden');
        }

        function showGameOverModal() {
            gameOverModal.classList.remove('hidden');
        }

        function animateMario() {
            setInterval(() => {
                marioPosition += 2; // Velocidade
                if (marioPosition > window.innerWidth) {
                    showCongratsModal();
                    return;
                }
                mario.style.left = `${marioPosition}px`;
            }, 50);
        }

        nextLevelBtn.addEventListener('click', () => {
            window.location.href = '/level5';
        });

        restartBtn.addEventListener('click', resetGame);

        animateMario();
        setTimeout(showQuestion, 3000);
    </script>
</body>
</html>